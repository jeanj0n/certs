# Malware

The AAA's of Security

1. Authentication - Something you know/are/have/do or Somewhere you are
2. Authorization - Restrict access to certain piece of data&#x20;
3. Accounting - Keep track of data, normally recorded in log files

Different Attack frameworks and a lot

### Malware

1. Virus - need user action to take over (eg. clicking on setup file for installing game)\
   a. Boot sector - installed in boot sector, hard to find\
   b. Macro - common, like example above\
   c. Multipartite - combine boot and program viruses\
   d. Polymorphic - Encrypted virus changes everytime on exec\
   e. Metamorphic - advanced vers of poly, rewrites entirely before infecting\
   f. Stealth - above two\
   g. Armored - layer of protection to prevent analyzing\
   h. Hoax - scamming ppl into bottling it
2. Worm - can replicate wo user interaction
3. Trojan - malicious but acts safe&#x20;
4. Ransomware - limit access till you pay up&#x20;
5. Spyware - gather info wo user consent , grayware aint good or bood itjus crazy
6. **Rootkit - activated before os,  gain admin control over system wo detection**\
   **\*shimming - placed bw two components to intercept and redirect traffic, cause dll injection and driver injection**

## Malware Infections

Threat vector: Method used by attacker to access machine (eg. phishing, physical etc.)

Attack vector: Method to access and infect with malware

Most common types: software, messaging and media

Watering hole: place you keep coming back to, (water in africa) if you can exploit that then you can compromise the ppl who come use it\
Malware placed in a website knowing ppl will come use it

Active Interception : When ppl bw you and internet, they can read your stuff and modify responses too

Backdoor: for maintanence no need to go through layers of authentication, **Horrible idea if found you ded**

Logic Bomb: Easter egg with malicious intent, when cerain conditions met exec code

### How to Identify

Bsod

Laggy, print random chars

Physical files not accessible

Double file extension

### Removing&#x20;

1. Identify malware symptoms
2. Quarantine infected systems
3. Disable System restore (so system no take snapshot of its infected state)
4. Fix infected system (Safe mode and scan)
5. Auto updates and scans
6. User training

If boot sector virus, boot from external drive and scan cus otherwise when boot it read virus along with it. An external drive can scan internal also

### Prevent

* Virus : Antivirus, System Updates, Host based firewall (no external connections, SSL websites no MITM
* Malware : Anti-malware solution, you find it from its attack definition not the thing itself
* Spyware : Anti-spyware, Windows Defender, Low level trust policy for internet
* Rootkit : External device scan before install, once install reimage using trusted baseline
* Spam - ensure your mail not used for spam services, disable open relay smtp settings

### Exploit

Most malware use fileless techniques to prevent signature based checks (eg. script/shellcode create process and then delete itself. this might download the rest of the malware)

Dropper: Malware designed to run or install other types of malware embedded on a payload on an infected host

Downloader : code to retrieve rest code from internet after initiation by dropper

Shellcode (Pentest+) : code which when you run gives a shell\
&#x20;                 (Sec+): any lightweight code which can run an exploit

Execute using Code Injection of legit process

* Masquerading: dropper replace genuine exe with malicious one
* DLL injection : forces process to load as part of the DLL
* DLL Sideloading: Load malicious at runtime by exploiting it, the real DLL now sidelined
* Process hollowing: suspends it, rewrites memory address code and exec

Living off the Land : \[Pentester and Hacker technique] Using your native processes and applications against you (eg. bash script once privesc)
